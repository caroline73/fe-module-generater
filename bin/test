#!/usr/bin/env node
var readline = require('readline');

//创建readline接口实例
var  rl = readline.createInterface({
    input:process.stdin,
    output:process.stdout
});

function read(question, cb) {
  return function() {
    return new Promise(resolve => {
      rl.question(question,function(answer){
        cb();
        resolve(answer);
      });
    });
  };
}
function close() {
  return rl.close();
}
function compose(...args) {
  return args.reduce((a, b) => {
    return function() {
      return a().then(() => {
        return b();
      });
    };
  });
}

var a = compose(read('a?', function() {console.log('a')}), read('b?', function() {console.log('b');}), read('e?', function() {console.log('c');}), close);
// var b = compose(read('c?'), read('d?'));
// var total = compose(a, b, close);
a();
// total();


// var s = ['a?', 'b?'];

// s.reduce((a, b) => {
//   return read(a).then((_) => {
//     console.log('====', _)
//     return read(b); 
//   });
// }).then(() => {
//   rl.close()
// });